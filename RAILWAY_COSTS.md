# Railway — Расчет стоимости для English Trainer Bot

## Тарификация Railway (2026)

### Free Tier
- **$5 в месяц бесплатно** в виде кредитов
- 500 часов выполнения (execution hours)
- Unlimited deploys
- Все функции платформы доступны

### Платные ресурсы
После $5 free tier:
- **Compute**: $0.000231 за GB-секунду
- **RAM**: включено в compute
- **Network Egress**: первые 100 GB бесплатно, потом $0.10/GB

---

## Расчет для нашего бота

### Компоненты

1. **Bot Service (Node.js)**
   - Idle: ~100-200 MB RAM
   - Active (при работе с LLM): ~300-500 MB RAM
   - CPU: минимальное использование (бот на long polling)

2. **Redis Service**
   - ~50-100 MB RAM
   - CPU: минимальное использование

### Примеры использования

#### Сценарий 1: Легкая нагрузка (10-20 юзеров/день)
**Характеристики:**
- 10-20 запросов в день
- 2-3 активные сессии в час
- Бот в idle большую часть времени

**Расчет:**
- Bot: 200 MB × 730 часов/месяц = 146 GB-часов = **$0.03/месяц**
- Redis: 100 MB × 730 часов/месяц = 73 GB-часов = **$0.015/месяц**
- **Итого: ~$0.05/месяц** ✅ **Покрывается FREE tier**

---

#### Сценарий 2: Средняя нагрузка (100-200 юзеров/день)
**Характеристики:**
- 100-200 запросов в день
- 20-30 активных сессий в час
- Периодические пики нагрузки

**Расчет:**
- Bot: 400 MB × 730 часов/месяц = 292 GB-часов = **$0.06/месяц**
- Redis: 100 MB × 730 часов/месяц = 73 GB-часов = **$0.015/месяц**
- Network: ~5 GB/месяц = **бесплатно** (до 100 GB)
- **Итого: ~$0.08/месяц** ✅ **Покрывается FREE tier**

---

#### Сценарий 3: Высокая нагрузка (500+ юзеров/день)
**Характеристики:**
- 500+ запросов в день
- 100+ активных сессий в час
- Постоянная нагрузка

**Расчет:**
- Bot: 600 MB × 730 часов/месяц = 438 GB-часов = **$0.10/месяц**
- Redis: 150 MB × 730 часов/месяц = 109 GB-часов = **$0.025/месяц**
- Network: ~20 GB/месяц = **бесплатно** (до 100 GB)
- **Итого: ~$0.13/месяц** ✅ **Покрывается FREE tier**

---

#### Сценарий 4: Очень высокая нагрузка (2000+ юзеров/день)
**Характеристики:**
- 2000+ запросов в день
- 500+ активных сессий в час
- Постоянная высокая нагрузка

**Расчет:**
- Bot: 1 GB × 730 часов/месяц = 730 GB-часов = **$0.17/месяц**
- Redis: 200 MB × 730 часов/месяц = 146 GB-часов = **$0.034/месяц**
- Network: ~50 GB/месяц = **бесплатно** (до 100 GB)
- **Итого: ~$0.20/месяц** ✅ **Покрывается FREE tier**

---

## Основные расходы — LLM API!

### OpenAI GPT-4o-mini (рекомендуется для бота)
- **Input**: $0.150 за 1M токенов
- **Output**: $0.600 за 1M токенов

**Расчет на 1 запрос:**
- Генерация упражнения: ~500 токенов input + 300 токенов output = **$0.00027**
- Проверка ответа: ~200 токенов input + 100 токенов output = **$0.00009**
- **~1 сессия (10 упражнений)**: ~$0.0036

**Примеры:**
- 10 юзеров/день × 30 дней = 300 сессий = **$1.08/месяц**
- 100 юзеров/день × 30 дней = 3000 сессий = **$10.80/месяц**
- 500 юзеров/день × 30 дней = 15000 сессий = **$54/месяц**

### Google Gemini 2.0 Flash (бесплатная альтернатива)
- **Бесплатно** до 1500 запросов/день
- После: $0.075/$0.30 за 1M токенов

**Если использовать Gemini:**
- До 1500 запросов/день = **БЕСПЛАТНО** ✅
- ~150 юзеров/день = бесплатно

---

## Итоговая стоимость для разных сценариев

| Нагрузка | Юзеров/день | Railway | LLM (GPT-4o-mini) | LLM (Gemini) | **Итого (GPT)** | **Итого (Gemini)** |
|----------|-------------|---------|-------------------|--------------|-----------------|---------------------|
| Легкая   | 10-20       | FREE    | ~$1-2/мес         | FREE         | **$1-2/мес**    | **$0/мес** ✅       |
| Средняя  | 100-200     | FREE    | ~$10-20/мес       | FREE         | **$10-20/мес**  | **$0/мес** ✅       |
| Высокая  | 500+        | FREE    | ~$50-100/мес      | $20-40/мес   | **$50-100/мес** | **$20-40/мес**      |

---

## Рекомендации

### Для старта (MVP)
✅ **Railway Free Tier** — полностью покроет расходы на хостинг
✅ **Gemini 2.0 Flash** — бесплатно до 1500 запросов/день
✅ **Итого: $0/месяц** для первых 100-150 пользователей

### Для роста (после MVP)
- Railway: останется бесплатным или ~$1-2/мес
- Переход на **GPT-4o-mini** для лучшего качества (~$10-20/мес при 100-200 юзерах)

### Оптимизация расходов
1. **Кэширование LLM** — сохранять сгенерированные упражнения в БД (снизит запросы на 50-70%)
2. **Batch processing** — генерировать упражнения пачками (дешевле)
3. **Gemini для простых задач** — использовать Gemini для проверок, GPT для генерации
4. **Rate limiting** — ограничить количество запросов на пользователя (3-5 сессий/день)

---

## Выводы

✅ **Railway хостинг — НЕ проблема**, покрывается free tier
✅ **Основные расходы — LLM API**, но управляемые
✅ **Для MVP с Gemini — полностью бесплатно** до 150 юзеров/день
✅ **Масштабирование**: при росте до 500 юзеров/день — ~$20-40/мес

**Railway — отличный выбор для Telegram бота!**
